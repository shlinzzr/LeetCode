{"id":79274283,"question_id":171,"lang":"c","lang_name":"C","time":"7 years, 7 months","timestamp":1476948567,"status":10,"status_display":"Accepted","runtime":"6 ms","url":"/submissions/detail/79274283/","is_pending":"Not Pending","title":"Excel Sheet Column Number","memory":"N/A","code":"/*\r\nint titleToNumber(char* s) {\r\n    char *ptr = 'A' - '1';\r\n    int n = strlen(s);\r\n    char *arr = malloc(n *sizeof(char));\r\n    \r\n    //s = s-ptr;\r\n    \r\n    for(int i=0; i<n; i++)\r\n    {\r\n        arr[i]= s[i] - ptr[i];\r\n    }\r\n    \r\n    return arr;\r\n}\r\n\r\n*/\r\n\r\n//關鍵在於  result * 26 + *s++ - 'A' + 1   \r\n//Q1.為什麼字元可在int中被相減 \r\n//Q2.為何要*26 \r\n//Q3.為何+1\r\n\r\n//  註:\r\n//  result*26=0, s=25863776, *s=65  result=1\r\n//  result*26=0, s=25863808, *s=66  result=2\r\n//  result*26=0, s=25863776, *s=67  result=3\r\nint titleToNumber(char* s) {\r\n    \r\n    int result = 0;\r\n\twhile (*s){\r\n\t    printf(\"  result*26=%d, s=%d, *s=%d\",result, s, *s);\r\n\t\tresult = result * 26 + *s++ - 'A' + 1;\r\n\t\tprintf(\"  result=%d\\n\",result);\r\n\t}\r\n\treturn result;\r\n}","compare_result":null,"title_slug":"excel-sheet-column-number","has_notes":false,"flag_type":1}