{"id":922946652,"question_id":631,"lang":"java","lang_name":"Java","time":"1 year, 2 months","timestamp":1679913149,"status":10,"status_display":"Accepted","runtime":"7 ms","url":"/submissions/detail/922946652/","is_pending":"Not Pending","title":"Design Excel Sum Formula","memory":"42.7 MB","code":"public class Excel {\n    Cell[][] table;\n\n    public Excel(int H, char W) {\n        table = new Cell[H+1][W-'A'+1];\n    }\n    \n    public void set(int r, char c, int v) {\n        if(table[r][c-'A'] == null) table[r][c-'A'] = new Cell (v); \n        else table[r][c-'A'].setValue(v); \n    }\n    \n    public int get(int r, char c) {\n        if( table[r][c-'A'] == null) return 0;\n        else return table[r][c-'A'].getValue();  \n    }\n    \n    public int sum(int r, char c, String[] strs) {\n        if (table[r][c-'A'] == null) {\n            table[r][c-'A'] = new Cell(strs);\n        } else {\n            table[r][c-'A'].setFormula(strs);\n        }\n        \n        return table[r][c-'A'].getValue();\n    }\n    \n    \n    private class Cell{\n        int val=0;\n        HashMap<Cell, Integer> formula=new HashMap<>();//one cell might appear multiple times\n        \n        public Cell(int val){\n            setValue(val); \n        }\n        public Cell(String[] formulaStr){\n            setFormula(formulaStr);\n        }\n        \n        public void setValue(int val) {           \n            formula.clear(); //will not be treated as a formula cell anymore        \n            this.val = val;\n        }\n        \n        public void setFormula(String[] formulaStr){\n            formula.clear();            \n            for(String str : formulaStr){\n                if (str.indexOf(\":\")<0){\n                    int[] pos = getPos(str);\n                    addFormulaCell(pos[0], pos[1]);\n                } else {\n                    String[] pos = str.split(\":\");\n                    int[] startPos = getPos(pos[0]);\n                    int[] endPos = getPos(pos[1]);\n                    for(int r = startPos[0]; r<=endPos[0]; r++){\n                        for(int c = startPos[1]; c<=endPos[1]; c++){\n                            addFormulaCell(r, c);\n                        }\n                    }\n                }\n            }\n        }\n        \n        private int[] getPos(String str){\n            int[] pos = new int[2];\n            pos[1]=str.charAt(0)-'A';\n            pos[0]=Integer.parseInt(str.substring(1));\n            return pos;\n        }\n        \n        private void addFormulaCell(int r, int c){\n            if(table[r][c] == null) table[r][c] = new Cell(0);\n            Cell rangeCell = table[r][c];                            \n            formula.put(rangeCell, (formula.containsKey(rangeCell)? formula.get(rangeCell) : 0)+1);\n        }\n        \n        //recursive method\n        private int getValue(){\n            if(this.formula.isEmpty()) return this.val;\n            int sum = 0;\n            for(Cell cell : formula.keySet()){\n                sum+=cell.getValue()*formula.get(cell);\n            }\n            return sum;\n        }\n    }\n}","compare_result":"11111111111111111111111","title_slug":"design-excel-sum-formula","has_notes":false,"flag_type":1}