{"id":1253321331,"question_id":2176,"lang":"java","lang_name":"Java","time":"1Â month","timestamp":1715238025,"status":10,"status_display":"Accepted","runtime":"125 ms","url":"/submissions/detail/1253321331/","is_pending":"Not Pending","title":"Parallel Courses III","memory":"91.2 MB","code":"class Solution {\n    public int minimumTime(int n, int[][] relations, int[] time) {\n\n        int[] indeg = new int[n+1];\n        Map<Integer, Set<Integer>> preq = new HashMap<>();\n        Map<Integer, Set<Integer>> next = new HashMap<>();\n\n        for(int[] r : relations){\n            int prevCourse = r[0];\n            int nextCourse = r[1];\n\n            indeg[nextCourse]++;\n            preq.putIfAbsent(nextCourse, new HashSet<>());\n            preq.get(nextCourse).add(prevCourse);\n\n            next.putIfAbsent(prevCourse, new HashSet<>());\n            next.get(prevCourse).add(nextCourse);\n        }\n\n        // prev : 3: {1,2}\n        // next : 1 : {3}, 2:{3}\n        // indeg = 1, 2\n\n        PriorityQueue<int[]> q = new PriorityQueue<>(\n            (a,b)-> a[1]-b[1]\n        ); // courseIdx, currTime\n\n        for(int i=1; i<=n; i++){\n            if(indeg[i]==0){\n                q.offer( new int[]{i, time[i-1]});\n            }\n        }\n\n        // q : {1,0}, {2,0}\n\n\n        boolean[] finished = new boolean[n+1];\n\n        int curMax = 0;\n        while(!q.isEmpty()){\n\n            int[] p = q.poll();\n\n            int idx = p[0];\n            int cur = p[1];\n            curMax = Math.max(curMax, cur);\n            finished[idx] = true;\n\n            Set<Integer> adjs = next.getOrDefault(idx, new HashSet<>());\n            for(int adj : adjs){\n                preq.get(adj).remove(idx);\n                if(preq.get(adj).isEmpty()) q.offer(new int[]{adj, curMax+time[adj-1]});\n            }\n\n           \n\n        }\n\n        for(int i=1; i<n;i++){\n            if(finished[i]==false) return -1;\n        }\n\n        return curMax;\n        \n    }\n}","compare_result":"111111111111111111111111111111111111111111","title_slug":"parallel-courses-iii","has_notes":false,"flag_type":1}