{"id":907664672,"question_id":1710,"lang":"java","lang_name":"Java","time":"1 year, 3 months","timestamp":1677753307,"status":20,"status_display":"Compile Error","runtime":"N/A","url":"/submissions/detail/907664672/","is_pending":"Not Pending","title":"Find Servers That Handled Most Number of Requests","memory":"N/A","code":"class Solution {\n    public List<Integer> busiestServers(int k, int[] arrival, int[] load) {\n        int[] counter = new int[k];\n        // use a tree to track available servers\n        TreeSet<Integer> available = new TreeSet<Integer>();\n        for (int num = 0; num < k; num++) {\n            available.add(num);\n        }\n        // use a PQ to maintain the availability at current arrival time\n        Queue<int[]> busyServers = new PriorityQueue<>((a, b)->(a[0] - b[0]));\n        \n        for (int idx = 0; idx < arrival.length; idx++) {\n            int curTime = arrival[idx];\n            int endTime = curTime + load[idx];\n            while (!busyServers.isEmpty() && busyServers.peek()[0] <= curTime) {\n                int freedServer = busyServers.poll()[1];\n                available.add(freedServer);\n            }\n            if (available.size() == 0) continue; // all busy\n            Integer assignNum = available.ceiling(idx % k);\n            if (assignNum == null) {\n                assignNum = available.first();\n            }\n            counter[assignNum]++;\n            available.remove(assignNum);\n            busyServers.offer(new int[] {endTime, assignNum});\n        }\n        \n        return findMaxesInCounter(counter);\n    }\n    \n    \n    \n    private List<Integer> findMaxesInCounter(int[] counter) {\n        int max = 0;\n        for (int i = 0; i < counter.length; i++) {\n            max = Math.max(max, counter[i]);\n        }\n        List<Integer> result = new ArrayList<>();\n        for (int i = 0; i < counter.length; i++) {\n            if (counter[i] == max) {\n                result.add(i);\n            }\n        }\n        return result;\n    }\n}\n}","compare_result":null,"title_slug":"find-servers-that-handled-most-number-of-requests","has_notes":false,"flag_type":1}