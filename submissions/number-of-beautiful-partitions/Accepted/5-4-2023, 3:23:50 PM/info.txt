{"id":944229825,"question_id":2569,"lang":"java","lang_name":"Java","time":"1 year, 1 month","timestamp":1683185030,"status":10,"status_display":"Accepted","runtime":"248 ms","url":"/submissions/detail/944229825/","is_pending":"Not Pending","title":"Number of Beautiful Partitions","memory":"43.7 MB","code":"class Solution {\n    private static int M = 1_000_000_007;\n    private static boolean[] P = new boolean[10];\n    public int beautifulPartitions(String s, int k, int minL) {\n        int n = s.length();\n        if (minL*k > n) return 0; // corner case 1: total length is not enough\n\n        P[2] = P[3] = P[5] = P[7] = true;\n        if (!P[s.charAt(0)-'0'] || P[s.charAt(n-1)-'0']) return 0; // corner case 2: beginning or end is not valid\n        if (k == 1) return 1; //  corner case 3\n\n        List<Integer> begins = getValidBeginIndices(s, n, minL);\n        int m = begins.size();\n        if (m < k - 1) return 0; // corner case 4\n\n        int[][] dp = new int[k][m];\n        for (var _a : dp) Arrays.fill(_a, -1); // -1 means not visited\n\n        return dfs(begins, k-1, 0, 0, minL, dp); // select k-1 indices within array\n    }\n\n    private int dfs(List<Integer> begins, int k, int idx, int pre, int len, int[][] dp) {\n        if (k == 0) return 1; // selected everything\n        if (dp[k][idx] > -1) return dp[k][idx];\n\n        dp[k][idx] = 0; // do not select current\n        for (int i = idx; i <= begins.size()-k; i++) { // making sure there's enough left\n            int cur = begins.get(i);\n            if (cur - pre < len) continue;\n            dp[k][idx] = (dp[k][idx] + dfs(begins, k-1, i+1, cur, len, dp)) % M;\n        }\n\n        return dp[k][idx];\n    }\n\n    private List<Integer> getValidBeginIndices(String s, int n, int minL) {\n        List<Integer> begins = new ArrayList<>(n / 2 + 1);\n        for (int i = minL; i <= n - minL; i++) // find all valid beginning index\n            if (P[s.charAt(i)-'0'] && !P[s.charAt(i - 1)-'0']) begins.add(i);\n        return begins;\n    }\n}","compare_result":"11111111111111111111111111111111111111111111111111111111111111111111111111","title_slug":"number-of-beautiful-partitions","has_notes":false,"flag_type":1}